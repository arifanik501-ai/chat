/* =====================================================
   CHAT SCREEN — GLASSMORPHISM CRYSTAL PALACE
   =====================================================
   Layers (back→front):
   0: Animated gradient base + noise
   1: Chat wallpaper (doodle pattern + light spots)
   2: Depth fog (top/bottom)
   3: Glass message bubbles
   4: Glass header (fixed) + Glass input bar (fixed)
   5: Overlays, modals, menus (deep blur)
   6: FAB, toasts, tooltips
   ===================================================== */

/* ─── CRITICAL OVERRIDES (over style.css) ─── */
#chatscreen .input-container {
    background-color: transparent !important;
    background: transparent !important;
    border-radius: 0 !important;
    border: none !important;
    padding: 0 !important;
    min-height: unset !important;
}

#chatscreen .input-container.focused {
    border-color: transparent !important;
}

#chatscreen .emoji-btn,
#chatscreen .attach-btn,
#chatscreen .camera-btn {
    color: rgba(255, 255, 255, 0.5) !important;
    overflow: visible !important;
}

#chatscreen .chat-header {
    background-color: transparent !important;
}

#chatscreen .send-btn {
    background-color: transparent !important;
}

/* Attachment menu glass override */
#chatscreen .attachment-menu {
    background: rgba(11, 20, 26, 0.92) !important;
    background-color: rgba(11, 20, 26, 0.92) !important;
    backdrop-filter: blur(40px) !important;
    -webkit-backdrop-filter: blur(40px) !important;
    border: 1px solid rgba(255, 255, 255, 0.08) !important;
    box-shadow: 0 16px 48px rgba(0, 0, 0, 0.4) !important;
    border-radius: 20px !important;
}

#chatscreen .attach-grid {
    display: flex !important;
    justify-content: center !important;
    padding: 10px 0 !important;
}

#chatscreen .attach-option {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    gap: 8px !important;
}

#chatscreen .attach-option span {
    color: rgba(255, 255, 255, 0.6) !important;
    font-size: 11px !important;
}

#chatscreen .attach-icon-wrapper {
    width: 54px !important;
    height: 54px !important;
    border-radius: 50% !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
}

/* Message bubble overrides */
#chatscreen .message-bubble {
    color: rgba(255, 255, 255, 0.92) !important;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2), 0 1px 4px rgba(0, 0, 0, 0.15) !important;
    font-size: 14.5px !important;
    line-height: 1.45 !important;
    letter-spacing: 0.2px !important;
    text-shadow: 0 0.5px 2px rgba(0, 0, 0, 0.15) !important;
    backdrop-filter: blur(20px) saturate(120%);
    -webkit-backdrop-filter: blur(20px) saturate(120%);
}

#chatscreen .message-bubble.sent {
    background-color: rgba(0, 92, 75, 0.35) !important;
    background: linear-gradient(135deg, rgba(0, 92, 75, 0.35) 0%, rgba(0, 92, 75, 0.2) 100%) !important;
    border: 1px solid rgba(0, 168, 132, 0.15) !important;
    border-radius: 16px 16px 4px 16px !important;
}

#chatscreen .message-bubble.received {
    background-color: rgba(255, 255, 255, 0.1) !important;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%) !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    border-radius: 16px 16px 16px 4px !important;
}

#chatscreen .message-bubble .meta,
#chatscreen .message-bubble .time {
    color: rgba(255, 255, 255, 0.4) !important;
}

#chatscreen .message-bubble .ticks.read {
    color: #53BDEB !important;
    text-shadow: 0 0 6px rgba(83, 189, 235, 0.5) !important;
}

#chatscreen .message-bubble .ticks {
    color: rgba(255, 255, 255, 0.4) !important;
}

/* Date separator glass override */
#chatscreen .date-separator {
    background: rgba(255, 255, 255, 0.06) !important;
    background-color: rgba(255, 255, 255, 0.06) !important;
    color: rgba(255, 255, 255, 0.55) !important;
    backdrop-filter: blur(15px) !important;
    -webkit-backdrop-filter: blur(15px) !important;
    border: 1px solid rgba(255, 255, 255, 0.08) !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.08) !important;
    font-size: 11.5px !important;
    letter-spacing: 0.5px !important;
    text-transform: uppercase !important;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2) !important;
}

/* Message input text white */
#chatscreen .message-input {
    color: rgba(255, 255, 255, 0.87) !important;
    background: rgba(255, 255, 255, 0.06) !important;
    background-color: rgba(255, 255, 255, 0.06) !important;
    border: 1px solid rgba(255, 255, 255, 0.08) !important;
    border-radius: 24px !important;
}

#chatscreen .message-input:focus {
    border-color: rgba(0, 168, 132, 0.3) !important;
    background: rgba(255, 255, 255, 0.09) !important;
    box-shadow: 0 0 0 2px rgba(0, 168, 132, 0.1), 0 0 15px rgba(0, 168, 132, 0.05) !important;
}

/* ───── CHATSCREEN BASE ───── */
#chatscreen {
    background: #060D11;
    overflow: hidden;
}

/* ───── CHAT WALLPAPER: Living Textured Background ───── */
.chat-wallpaper {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 0;
    /* Base gradient — slow vertical shift */
    background: linear-gradient(170deg, #060D11 0%, #081420 25%, #060E18 50%, #0A1219 75%, #060D11 100%);
    background-size: 100% 400%;
    animation: wallpaperGradient 30s ease-in-out infinite;
}

@keyframes wallpaperGradient {
    0% {
        background-position: 0% 0%;
    }

    50% {
        background-position: 0% 100%;
    }

    100% {
        background-position: 0% 0%;
    }
}

/* Doodle pattern overlay */
.chat-wallpaper::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Cdefs%3E%3Cstyle%3E.s%7Bfill:rgba(255,255,255,0.012)%7D%3C/style%3E%3C/defs%3E%3Ccircle cx='20' cy='30' r='6' class='s'/%3E%3Crect x='60' y='15' width='8' height='12' rx='2' class='s' transform='rotate(15 64 21)'/%3E%3Ccircle cx='110' cy='25' r='5' class='s'/%3E%3Cpath d='M155 20l5 8H150z' class='s'/%3E%3Ccircle cx='30' cy='80' r='4' class='s'/%3E%3Crect x='80' y='70' width='10' height='10' rx='3' class='s' transform='rotate(-10 85 75)'/%3E%3Ccircle cx='140' cy='85' r='6' class='s'/%3E%3Cpath d='M175 75c3-5 7-5 10 0s-3 8-5 5' class='s'/%3E%3Crect x='15' y='130' width='7' height='10' rx='2' class='s' transform='rotate(20 18 135)'/%3E%3Ccircle cx='65' cy='140' r='5' class='s'/%3E%3Cpath d='M115 130l4 7h-8z' class='s'/%3E%3Ccircle cx='160' cy='135' r='4' class='s'/%3E%3Ccircle cx='45' cy='180' r='6' class='s'/%3E%3Crect x='95' y='175' width='8' height='8' rx='2' class='s' transform='rotate(30 99 179)'/%3E%3Cpath d='M150 170c2-4 6-4 8 0s-2 6-4 4' class='s'/%3E%3C/svg%3E");
    background-size: 200px 200px;
    animation: patternDrift 60s linear infinite;
    pointer-events: none;
}

@keyframes patternDrift {
    0% {
        background-position: 0 0;
    }

    100% {
        background-position: 200px 200px;
    }
}

/* Noise texture */
.chat-wallpaper::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    opacity: 0.02;
    mix-blend-mode: overlay;
    pointer-events: none;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    background-size: 128px 128px;
}

/* ───── PERFORMANCE BOOST FOR TRANSITIONS ───── */
/* Hide heavy SVG overlays and pause gradient animation during the sliding transition to save GPU */
#chatscreen.animating .chat-wallpaper {
    animation-play-state: paused !important;
    will-change: transform;
}

#chatscreen.animating .chat-wallpaper::before,
#chatscreen.animating .chat-wallpaper::after {
    display: none !important;
}

/* ───── DEPTH FOG (Top & Bottom) ───── */
.messages-top-glow {
    position: sticky;
    top: 0;
    left: 0;
    right: 0;
    height: 40px;
    background: linear-gradient(to bottom, rgba(11, 20, 26, 0.8) 0%, transparent 100%);
    z-index: 5;
    pointer-events: none;
    margin-bottom: -40px;
}

/* ───── GLASSMORPHISM CHAT HEADER ───── */
.chat-header {
    height: var(--header-height);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 8px;
    z-index: 100;
    position: relative;
    /* Glass effect */
    background: linear-gradient(180deg, rgba(11, 20, 26, 0.92) 0%, rgba(11, 20, 26, 0.85) 100%);
    backdrop-filter: blur(30px) saturate(180%) brightness(0.8);
    -webkit-backdrop-filter: blur(30px) saturate(180%) brightness(0.8);
    border-bottom: 1px solid rgba(255, 255, 255, 0.06);
    box-shadow: 0 1px 0 rgba(0, 168, 132, 0.15), 0 4px 15px rgba(0, 0, 0, 0.3);
    color: white;
    transition: backdrop-filter 0.3s, background 0.3s, box-shadow 0.3s;
}

/* Inner top highlight */
.chat-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent);
    pointer-events: none;
}

/* Scroll-responsive header darkening */
.chat-header.scrolled {
    background: linear-gradient(180deg, rgba(11, 20, 26, 0.95) 0%, rgba(11, 20, 26, 0.92) 100%);
    box-shadow: 0 1px 0 rgba(0, 168, 132, 0.2), 0 6px 20px rgba(0, 0, 0, 0.4);
}

/* Header layout */
.header-left {
    display: flex;
    align-items: center;
    flex: 1;
    cursor: pointer;
    overflow: hidden;
    gap: 2px;
}

.header-right {
    display: flex;
    align-items: center;
}

/* ── Glass Back Button ── */
.back-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    background: rgba(255, 255, 255, 0.06);
    border: 1px solid rgba(255, 255, 255, 0.08);
    margin-right: 4px;
    flex-shrink: 0;
    transition: all 0.15s ease;
}

.back-btn svg {
    filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.3));
    width: 20px;
    height: 20px;
}

.back-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.15);
    transform: scale(1.05);
}

.back-btn:active {
    background: rgba(255, 255, 255, 0.15);
    transform: scale(0.93) translateX(-2px) !important;
}

.back-btn.animate-in {
    animation: none;
    opacity: 1;
}

.back-btn.bounce-back {
    animation: none;
}

/* ── Chat Avatar with Glass Ring ── */
.chat-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 18px;
    color: white;
    flex-shrink: 0;
    position: relative;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    /* Ring via box-shadow */
    box-shadow: 0 0 0 2px rgba(0, 168, 132, 0.5), 0 0 12px rgba(0, 168, 132, 0.3);
    animation: avatarChatGlow 3s ease-in-out infinite;
}

@keyframes avatarChatGlow {

    0%,
    100% {
        box-shadow: 0 0 0 2px rgba(0, 168, 132, 0.4), 0 0 10px rgba(0, 168, 132, 0.2);
    }

    50% {
        box-shadow: 0 0 0 2px rgba(0, 168, 132, 0.6), 0 0 20px rgba(0, 168, 132, 0.35);
    }
}

/* Online dot */
.online-dot {
    display: inline-block;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #00A884;
    margin-left: 6px;
    vertical-align: middle;
    animation: sonarPing 2.5s infinite;
}

.online-dot.hide {
    display: none;
}

@keyframes sonarPing {
    0% {
        box-shadow: 0 0 0 0 rgba(0, 168, 132, 0.5);
        transform: scale(1);
    }

    70% {
        box-shadow: 0 0 0 8px rgba(0, 168, 132, 0);
        transform: scale(1);
    }

    100% {
        box-shadow: 0 0 0 0 rgba(0, 168, 132, 0);
        transform: scale(1);
    }
}

/* ── Contact Name & Status ── */
.chat-title-container {
    display: flex;
    flex-direction: column;
    margin-left: 10px;
    min-width: 0;
    flex: 1;
}

.chat-title {
    font-size: 17px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.92);
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.chat-status-wrapper {
    height: 18px;
    overflow: hidden;
    position: relative;
}

.chat-status {
    font-size: 13px;
    font-weight: 400;
    display: block;
    white-space: nowrap;
    transition: transform 0.25s ease, opacity 0.25s ease;
}

/* Status online = green glow */
.chat-status.status-online {
    color: #00A884;
    text-shadow: 0 0 8px rgba(0, 168, 132, 0.4);
}

/* Status typing = shimmer gradient */
.chat-status.status-typing {
    background: linear-gradient(90deg, #00A884 0%, #53BDEB 50%, #00A884 100%);
    background-size: 200% 100%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: typingShimmer 2s linear infinite;
}

@keyframes typingShimmer {
    0% {
        background-position: -200% 0;
    }

    100% {
        background-position: 200% 0;
    }
}

/* Default status */
.chat-status {
    color: rgba(255, 255, 255, 0.45);
}

/* Slot machine transitions */
.chat-status.slot-visible {
    transform: translateY(0);
    opacity: 1;
}

.chat-status.slot-hidden-up {
    transform: translateY(-15px);
    opacity: 0;
    position: absolute;
}

.chat-status.slot-hidden-down {
    transform: translateY(15px);
    opacity: 0;
    position: absolute;
}

/* ── Glass Menu Button ── */
.menu-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: rgba(255, 255, 255, 0.7);
    background: rgba(255, 255, 255, 0.06);
    border: 1px solid rgba(255, 255, 255, 0.08);
    transition: all 0.15s ease;
}

.menu-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.9);
}

.menu-btn:active {
    background: rgba(255, 255, 255, 0.15);
    transform: scale(0.93);
}

/* ───── MESSAGES AREA ───── */
.chat-messages {
    flex: 1;
    display: block !important;
    /* Override flex from style.css which breaks scrolling */
    overflow-y: auto;
    overflow-x: hidden;
    position: relative;
    z-index: 2;
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
    padding-top: 8px;
    padding-bottom: 8px;
}

.messages-container {
    min-height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    padding: 4px 12px;
}

/* ───── GLASS MESSAGE BUBBLES ───── */
.message-bubble {
    max-width: 78%;
    min-width: 80px;
    padding: 7px 11px 6px 11px;
    margin-bottom: 4px;
    position: relative;
    word-break: break-word;
    white-space: pre-wrap;
    border-radius: 16px;
    z-index: 3;
    /* Glass base */
    backdrop-filter: blur(20px) saturate(120%);
    -webkit-backdrop-filter: blur(20px) saturate(120%);
    transition: all 0.2s ease;
}

/* Glass reflection on top */
.message-bubble::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 40%;
    border-radius: inherit;
    background: linear-gradient(to bottom, rgba(255, 255, 255, 0.06) 0%, transparent 100%);
    pointer-events: none;
    opacity: 0.5;
}

/* ── Sent Bubble (green glass) ── */
.message-bubble.sent {
    align-self: flex-end;
    margin-left: 48px;
    background: linear-gradient(135deg, rgba(0, 92, 75, 0.35) 0%, rgba(0, 92, 75, 0.2) 100%);
    border: 1px solid rgba(0, 168, 132, 0.15);
    border-radius: 16px 16px 4px 16px;
    box-shadow:
        0 4px 15px rgba(0, 0, 0, 0.2),
        0 1px 4px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.08),
        inset 0 -1px 0 rgba(0, 0, 0, 0.05);
}

/* Inner glow */
.message-bubble.sent::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: inherit;
    background: radial-gradient(ellipse at 20% 20%, rgba(0, 168, 132, 0.1) 0%, transparent 60%);
    pointer-events: none;
}

/* ── Received Bubble (frost glass) ── */
.message-bubble.received {
    align-self: flex-start;
    margin-right: 48px;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 16px 16px 16px 4px;
    box-shadow:
        0 4px 15px rgba(0, 0, 0, 0.15),
        0 1px 4px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        inset 0 -1px 0 rgba(0, 0, 0, 0.03);
}

.message-bubble.received::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: inherit;
    background: radial-gradient(ellipse at 80% 20%, rgba(255, 255, 255, 0.06) 0%, transparent 60%);
    pointer-events: none;
}

/* Hover glow */
.message-bubble:hover {
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.18);
}

.message-bubble.sent:hover {
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25), 0 0 20px rgba(0, 168, 132, 0.1);
    background: linear-gradient(135deg, rgba(0, 92, 75, 0.4) 0%, rgba(0, 92, 75, 0.25) 100%);
}

.message-bubble.received:hover {
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2), 0 0 20px rgba(255, 255, 255, 0.05);
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.13) 0%, rgba(255, 255, 255, 0.07) 100%);
}

/* ── Bubble Entrance Animations ── */
.message-bubble.sent.new-msg {
    animation: glassBubbleSent 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

@keyframes glassBubbleSent {
    0% {
        opacity: 0;
        transform: translateY(20px) translateX(15px) scale(0.7);
    }

    60% {
        transform: translateY(-3px) translateX(0) scale(1.02);
    }

    80% {
        transform: translateY(1px) scale(0.99);
    }

    100% {
        opacity: 1;
        transform: translateY(0) translateX(0) scale(1);
    }
}

.message-bubble.received.new-msg {
    animation: glassBubbleReceived 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

@keyframes glassBubbleReceived {
    0% {
        opacity: 0;
        transform: translateX(-25px) translateY(10px) scale(0.75);
    }

    50% {
        transform: translateX(4px) translateY(-2px) scale(1.03);
    }

    75% {
        transform: translateX(-1px) translateY(1px) scale(0.99);
    }

    100% {
        opacity: 1;
        transform: translateX(0) translateY(0) scale(1);
    }
}

/* ── Message Text ── */
.message-bubble .text {
    font-size: 14.5px;
    line-height: 1.45;
    color: rgba(255, 255, 255, 0.92);
    letter-spacing: 0.2px;
    text-shadow: 0 0.5px 2px rgba(0, 0, 0, 0.15);
    position: relative;
    z-index: 1;
}

.message-bubble a {
    color: #53BDEB;
    text-decoration: none;
}

.message-bubble a:hover {
    text-decoration: underline;
    text-shadow: 0 0 6px rgba(83, 189, 235, 0.3);
}

/* ── Timestamp & Ticks ── */
.message-bubble .meta {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 4px;
    margin-top: 2px;
    position: relative;
    z-index: 1;
}

.message-bubble .time {
    font-size: 11px;
    color: rgba(255, 255, 255, 0.4);
}

.message-bubble .ticks {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.4);
    letter-spacing: -2px;
}

.message-bubble .ticks.read {
    color: #53BDEB;
    text-shadow: 0 0 6px rgba(83, 189, 235, 0.5), 0 0 12px rgba(83, 189, 235, 0.2);
}

/* ── Emoji-Only Messages ── */
.message-bubble.emoji-only {
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    padding: 4px 8px;
}

.message-bubble.emoji-only::before,
.message-bubble.emoji-only::after {
    display: none;
}

.message-bubble.emoji-only .text {
    text-shadow: none;
}

.message-bubble.emoji-only.emoji-1 .text {
    font-size: 56px;
    line-height: 1.2;
}

.message-bubble.emoji-only.emoji-2 .text {
    font-size: 44px;
    line-height: 1.2;
}

.message-bubble.emoji-only.emoji-3 .text {
    font-size: 36px;
    line-height: 1.2;
}

/* Emoji shadow */
.message-bubble.emoji-only .text {
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
}

/* Emoji timestamp pill */
.message-bubble.emoji-only .meta {
    background: rgba(255, 255, 255, 0.06);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    border-radius: 6px;
    padding: 2px 8px;
    margin-top: 4px;
    display: inline-flex;
    float: right;
}

/* ── Date Separator (Glass Pill) ── */
.date-separator {
    text-align: center;
    margin: 16px 0;
    position: sticky;
    top: 8px;
    z-index: 6;
}

.date-separator span {
    display: inline-block;
    font-size: 11.5px;
    color: rgba(255, 255, 255, 0.55);
    letter-spacing: 0.5px;
    text-transform: uppercase;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    background: rgba(255, 255, 255, 0.06);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 8px;
    padding: 4px 14px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.08);
}

/* ── Typing Indicator ── */
.typing-indicator {
    display: none;
    align-self: flex-start;
    padding: 10px 18px;
    margin-bottom: 4px;
    /* Glass styling */
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
    backdrop-filter: blur(20px) saturate(120%);
    -webkit-backdrop-filter: blur(20px) saturate(120%);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 16px 16px 16px 4px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.typing-indicator.show {
    display: flex;
    gap: 6px;
    align-items: center;
    animation: glassBubbleReceived 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.typing-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    animation: glassDotBounce 1.4s infinite;
}

.typing-dot:nth-child(2) {
    animation-delay: 0.15s;
}

.typing-dot:nth-child(3) {
    animation-delay: 0.3s;
}

@keyframes glassDotBounce {

    0%,
    60%,
    100% {
        transform: translateY(0) scale(1);
        background: rgba(255, 255, 255, 0.3);
        box-shadow: none;
    }

    30% {
        transform: translateY(-10px) scale(1.2);
        background: rgba(255, 255, 255, 0.7);
        box-shadow: 0 0 8px rgba(255, 255, 255, 0.3), 0 4px 6px rgba(0, 0, 0, 0.2);
    }
}

/* ───── GLASSMORPHISM INPUT BAR ───── */
.chat-input-area {
    z-index: 100;
    padding: 8px 8px;
    padding-bottom: calc(8px + env(safe-area-inset-bottom, 0px));
    position: relative;
    /* Glass effect */
    background: linear-gradient(0deg, rgba(11, 20, 26, 0.95) 0%, rgba(11, 20, 26, 0.85) 100%);
    backdrop-filter: blur(40px) saturate(200%);
    -webkit-backdrop-filter: blur(40px) saturate(200%);
    border-top: 1px solid rgba(255, 255, 255, 0.06);
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.25), 0 -1px 4px rgba(0, 0, 0, 0.15);
}

/* Green tinted top edge */
.chat-input-area::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(0, 168, 132, 0.1), transparent);
    pointer-events: none;
}

.input-container {
    display: flex;
    align-items: flex-end;
    gap: 6px;
}

/* ── Glass Pill Input ── */
.message-input {
    flex: 1;
    min-height: 40px;
    max-height: 120px;
    padding: 10px 16px;
    font-size: 15px;
    line-height: 1.35;
    color: rgba(255, 255, 255, 0.87);
    border-radius: 24px;
    background: rgba(255, 255, 255, 0.06);
    border: 1px solid rgba(255, 255, 255, 0.08);
    outline: none;
    overflow-y: auto;
    word-break: break-word;
    transition: border-color 0.25s ease, background 0.25s ease, box-shadow 0.25s ease;
}

.message-input:empty::before {
    content: attr(data-placeholder);
    color: rgba(255, 255, 255, 0.3);
    font-size: 15px;
    pointer-events: none;
}

.message-input:focus {
    border-color: rgba(0, 168, 132, 0.3);
    background: rgba(255, 255, 255, 0.09);
    box-shadow: 0 0 0 2px rgba(0, 168, 132, 0.1), 0 0 15px rgba(0, 168, 132, 0.05);
}

/* ── Glass Circle Buttons ── */
.emoji-btn,
.attach-btn,
.camera-btn-input {
    width: 36px;
    height: 36px;
    min-width: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: rgba(255, 255, 255, 0.5);
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.06);
    flex-shrink: 0;
    transition: all 0.15s ease;
}

.emoji-btn:hover,
.attach-btn:hover,
.camera-btn-input:hover {
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.8);
}

.emoji-btn:active,
.attach-btn:active,
.camera-btn-input:active {
    transform: scale(0.92);
    background: rgba(255, 255, 255, 0.15);
}

.emoji-btn svg,
.attach-btn svg,
.camera-btn-input svg {
    width: 22px;
    height: 22px;
}

/* Emoji toggles */
.emoji-icon-container {
    position: relative;
    width: 24px;
    height: 24px;
}

.emoji-icon-container svg {
    position: absolute;
    top: 0;
    left: 0;
    transition: transform 0.3s, opacity 0.3s;
}

.emoji-icon-container .icon-keyboard {
    opacity: 0;
    transform: rotate(-90deg) scale(0);
}

.emoji-btn.active .icon-smiley {
    opacity: 0;
    transform: rotate(90deg) scale(0);
}

.emoji-btn.active .icon-keyboard {
    opacity: 1;
    transform: rotate(0) scale(1);
}

/* ── Send / Mic Button ── */
.send-btn {
    width: 42px;
    height: 42px;
    min-width: 42px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    background: linear-gradient(135deg, #00A884, #25D366);
    flex-shrink: 0;
    transition: all 0.15s ease;
    position: relative;
    overflow: visible;
    box-shadow: 0 0 15px rgba(0, 168, 132, 0.3), 0 0 30px rgba(0, 168, 132, 0.1);
    animation: sendGlow 3s infinite ease-in-out;
}

@keyframes sendGlow {

    0%,
    100% {
        box-shadow: 0 0 12px rgba(0, 168, 132, 0.25), 0 0 25px rgba(0, 168, 132, 0.08);
    }

    50% {
        box-shadow: 0 0 20px rgba(0, 168, 132, 0.45), 0 0 40px rgba(0, 168, 132, 0.15);
    }
}

.send-btn svg {
    width: 22px;
    height: 22px;
    filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.2));
    transition: transform 0.2s ease;
}

.send-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 0 25px rgba(0, 168, 132, 0.5), 0 0 45px rgba(0, 168, 132, 0.2);
}

.send-btn:active {
    transform: scale(0.85) !important;
    transition: 0.08s ease-in;
}

/* Mic/Send icon swap */
.send-btn .icon-mic {
    transition: transform 0.15s, opacity 0.15s;
}

.send-btn .icon-send {
    position: absolute;
    opacity: 0;
    transform: scale(0) rotate(-90deg);
    transition: transform 0.25s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.15s;
}

.send-btn.send-mode .icon-mic {
    opacity: 0;
    transform: scale(0) rotate(90deg);
}

.send-btn.send-mode .icon-send {
    opacity: 1;
    transform: scale(1) rotate(0);
}

.send-btn.send-mode {
    animation: sendGlow 1.5s infinite ease-in-out;
}

/* ───── SCROLL-TO-BOTTOM GLASS FAB ───── */
.scroll-bottom-btn {
    position: absolute;
    bottom: 16px;
    right: 16px;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    z-index: 50;
    display: none;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    /* Glass */
    background: rgba(30, 42, 50, 0.8);
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3), 0 1px 4px rgba(0, 0, 0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1);
    color: white;
    transition: all 0.2s ease;
}

.scroll-bottom-btn svg {
    filter: drop-shadow(0 0 3px rgba(255, 255, 255, 0.3));
}

.scroll-bottom-btn.show {
    display: flex;
    animation: fabGlassIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes fabGlassIn {
    0% {
        opacity: 0;
        transform: scale(0) translateY(20px);
    }

    60% {
        transform: scale(1.15) translateY(-3px);
    }

    80% {
        transform: scale(0.95) translateY(1px);
    }

    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.scroll-bottom-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4), 0 2px 8px rgba(0, 0, 0, 0.3);
}

.scroll-bottom-btn:active {
    transform: scale(0.85);
}

/* Unread badge */
.unread-badge {
    position: absolute;
    top: -5px;
    right: -5px;
    min-width: 18px;
    height: 18px;
    border-radius: 50%;
    background: linear-gradient(135deg, #00A884, #25D366);
    color: white;
    font-size: 11px;
    font-weight: 700;
    display: none;
    align-items: center;
    justify-content: center;
    border: 2px solid rgba(11, 20, 26, 0.9);
    box-shadow: 0 0 8px rgba(0, 168, 132, 0.4);
    padding: 0 4px;
}

.unread-badge.show {
    display: flex;
    animation: badgeBounce 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes badgeBounce {
    0% {
        transform: scale(0)
    }

    60% {
        transform: scale(1.3)
    }

    100% {
        transform: scale(1)
    }
}

/* ───── SKELETON LOADER (Glass) ───── */
.skeleton-loader {
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding: 16px 12px;
}

.skeleton-bubble {
    height: 38px;
    border-radius: 16px;
    background: rgba(255, 255, 255, 0.04);
    border: 1px solid rgba(255, 255, 255, 0.03);
    position: relative;
    overflow: hidden;
}

.skeleton-bubble::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(105deg, transparent 30%, rgba(255, 255, 255, 0.03) 50%, transparent 70%);
    animation: skeletonShimmer 1.5s infinite;
}

@keyframes skeletonShimmer {
    to {
        left: 200%;
    }
}

.skeleton-bubble.left {
    align-self: flex-start;
}

.skeleton-bubble.right {
    align-self: flex-end;
}

.skeleton-bubble.w45 {
    width: 45%;
}

.skeleton-bubble.w50 {
    width: 50%;
}

.skeleton-bubble.w55 {
    width: 55%;
}

.skeleton-bubble.w60 {
    width: 60%;
}

.skeleton-bubble.w65 {
    width: 65%;
}

.skeleton-bubble.w70 {
    width: 70%;
}

/* ───── IMAGE MESSAGES (Glass) ───── */
.message-bubble.image-message {
    padding: 4px;
}

.message-bubble.image-message img,
.message-bubble.image-message video {
    border-radius: 12px;
    max-width: 100%;
    display: block;
    box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.15);
}

.message-bubble.sent.image-message img {
    border: 1px solid rgba(0, 168, 132, 0.2);
}

.message-bubble.received.image-message img {
    border: 1px solid rgba(255, 255, 255, 0.12);
}

/* Image caption */
.message-bubble.image-message .caption {
    padding: 6px 8px 2px;
    position: relative;
    z-index: 1;
}

/* Image loading frost */
.message-bubble.image-message .image-loading {
    filter: blur(15px) brightness(0.7) saturate(0.5);
    transition: filter 0.5s ease-out;
}

.message-bubble.image-message .image-loaded {
    filter: none;
}

/* ───── GLASS TOAST ───── */
.toast-container {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 10000;
    display: flex;
    flex-direction: column;
    gap: 8px;
    pointer-events: none;
}

.toast {
    padding: 10px 20px;
    border-radius: 12px;
    font-size: 13px;
    color: rgba(255, 255, 255, 0.9);
    background: rgba(30, 42, 50, 0.9);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.08);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
    animation: toastIn 0.4s ease-out;
    pointer-events: auto;
    text-align: center;
    white-space: nowrap;
}

.toast.success {
    border-left: 3px solid #00A884;
}

.toast.error {
    border-left: 3px solid #FF4444;
}

.toast.info {
    border-left: 3px solid #53BDEB;
}

@keyframes toastIn {
    0% {
        opacity: 0;
        transform: translateY(-20px) scale(0.9);
    }

    100% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.toast.toast-exit {
    animation: toastOut 0.3s ease-in forwards;
}

@keyframes toastOut {
    to {
        opacity: 0;
        transform: translateY(-20px) scale(0.9);
    }
}

/* ───── GLASS CONTEXT MENU ───── */
.context-menu {
    position: fixed;
    border-radius: 16px;
    z-index: 500;
    min-width: 180px;
    padding: 8px 0;
    transform: scale(0.4) translateY(-10px);
    transform-origin: top left;
    opacity: 0;
    pointer-events: none;
    /* Glass */
    background: linear-gradient(170deg, rgba(30, 42, 50, 0.92) 0%, rgba(20, 32, 40, 0.88) 100%);
    backdrop-filter: blur(50px) saturate(200%);
    -webkit-backdrop-filter: blur(50px) saturate(200%);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 16px 48px rgba(0, 0, 0, 0.4), 0 4px 16px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.12);
    transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.25s ease;
}

.context-menu.show {
    transform: scale(1) translateY(0);
    opacity: 1;
    pointer-events: auto;
}

.context-menu .menu-item {
    display: flex;
    align-items: center;
    padding: 12px 18px;
    color: rgba(255, 255, 255, 0.82);
    font-size: 14.5px;
    cursor: pointer;
    transition: background 0.15s;
    border-bottom: 1px solid rgba(255, 255, 255, 0.04);
}

.context-menu .menu-item:last-child {
    border-bottom: none;
}

.context-menu .menu-item:hover,
.context-menu .menu-item:active {
    background: rgba(255, 255, 255, 0.06);
}

.context-menu .context-delete {
    color: #FF6B6B;
}

/* ───── GLASS BLUR OVERLAY ───── */
.blur-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.35);
    backdrop-filter: blur(12px) saturate(80%) brightness(0.7);
    -webkit-backdrop-filter: blur(12px) saturate(80%) brightness(0.7);
    z-index: 200;
    display: none;
    align-items: center;
    justify-content: center;
}

.blur-overlay.show {
    display: flex;
    animation: overlayIn 0.3s ease-out;
}

@keyframes overlayIn {
    0% {
        opacity: 0;
    }

    100% {
        opacity: 1;
    }
}

.blur-overlay.no-blur {
    background: transparent;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
}

/* ── Glass Dropdown Menu ── */
.dropdown-menu {
    position: absolute;
    top: 50px;
    right: 8px;
    width: 200px;
    border-radius: 16px;
    z-index: 201;
    padding: 6px 0;
    /* Glass */
    background: linear-gradient(170deg, rgba(30, 42, 50, 0.92) 0%, rgba(20, 32, 40, 0.88) 100%);
    backdrop-filter: blur(50px) saturate(200%);
    -webkit-backdrop-filter: blur(50px) saturate(200%);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 16px 48px rgba(0, 0, 0, 0.4), 0 4px 16px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.12);
    transform: scale(0.4) translateY(-10px);
    transform-origin: top right;
    opacity: 0;
    pointer-events: none;
    transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.25s ease;
}

.dropdown-menu.show {
    transform: scale(1) translateY(0);
    opacity: 1;
    pointer-events: auto;
}

.dropdown-menu .menu-item {
    padding: 14px 20px;
    color: rgba(255, 255, 255, 0.82);
    font-size: 14.5px;
    cursor: pointer;
    transition: background 0.15s;
    border-bottom: 1px solid rgba(255, 255, 255, 0.04);
}

.dropdown-menu .menu-item:last-child {
    border-bottom: none;
}

.dropdown-menu .menu-item:hover {
    background: rgba(255, 255, 255, 0.06);
}

.dropdown-menu .menu-item:active {
    background: rgba(255, 255, 255, 0.1);
}

/* ── Glass Confirm Dialog ── */
.confirm-dialog {
    width: calc(100% - 48px);
    max-width: 320px;
    border-radius: 20px;
    padding: 24px;
    z-index: 202;
    /* Deep glass */
    background: rgba(20, 32, 40, 0.95);
    backdrop-filter: blur(60px);
    -webkit-backdrop-filter: blur(60px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 24px 60px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.12);
    text-align: center;
    transform: scale(0.7);
    opacity: 0;
    pointer-events: none;
    transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.2s;
}

.confirm-dialog.show {
    transform: scale(1);
    opacity: 1;
    pointer-events: auto;
}

.confirm-dialog h3 {
    font-size: 17px;
    font-weight: 700;
    color: white;
    margin-bottom: 8px;
}

.confirm-dialog p {
    font-size: 13px;
    color: rgba(255, 255, 255, 0.5);
    margin-bottom: 20px;
}

.dialog-actions {
    display: flex;
    gap: 12px;
}

.dialog-btn {
    flex: 1;
    padding: 12px;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.15s ease;
}

.dialog-btn.cancel {
    background: rgba(255, 255, 255, 0.06);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.7);
}

.dialog-btn.cancel:hover {
    background: rgba(255, 255, 255, 0.1);
}

.dialog-btn.cancel:active {
    transform: scale(0.95);
}

.dialog-btn.danger {
    background: linear-gradient(135deg, #FF4444, #FF6B6B);
    border: none;
    color: white;
    box-shadow: 0 0 15px rgba(255, 68, 68, 0.3);
}

.dialog-btn.danger:hover {
    box-shadow: 0 0 25px rgba(255, 68, 68, 0.5);
}

.dialog-btn.danger:active {
    transform: scale(0.95);
}

/* ── Glass Attachment Menu ── */
.attachment-menu {
    position: absolute;
    bottom: 60px;
    left: 50%;
    transform: translateX(-50%) scale(0);
    z-index: 201;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    padding: 24px 20px;
    border-radius: 20px;
    opacity: 0;
    pointer-events: none;
    /* Glass */
    background: rgba(11, 20, 26, 0.8);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border: 1px solid rgba(255, 255, 255, 0.08);
    box-shadow: 0 16px 48px rgba(0, 0, 0, 0.4);
    transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.25s;
}

.attachment-menu.show {
    transform: translateX(-50%) scale(1);
    opacity: 1;
    pointer-events: auto;
}

.attach-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    cursor: pointer;
}

.attach-option-circle {
    width: 54px;
    height: 54px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 22px;
    color: white;
    position: relative;
    transition: all 0.2s ease;
    /* Glass sheen */
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.attach-option-circle::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.25) 0%, transparent 60%);
    pointer-events: none;
}

.attach-option-circle:hover {
    transform: scale(1.1);
}

.attach-option-circle:active {
    transform: scale(0.85);
}

/* Colors for each */
.attach-camera {
    background: linear-gradient(135deg, #FF6B8A, #FF4081);
    box-shadow: 0 4px 12px rgba(255, 64, 129, 0.35);
}

.attach-gallery {
    background: linear-gradient(135deg, #7C4DFF, #B388FF);
    box-shadow: 0 4px 12px rgba(124, 77, 255, 0.35);
}

.attach-document {
    background: linear-gradient(135deg, #448AFF, #82B1FF);
    box-shadow: 0 4px 12px rgba(68, 138, 255, 0.35);
}

.attach-audio {
    background: linear-gradient(135deg, #FF9100, #FFB74D);
    box-shadow: 0 4px 12px rgba(255, 145, 0, 0.35);
}

.attach-location {
    background: linear-gradient(135deg, #00C853, #69F0AE);
    box-shadow: 0 4px 12px rgba(0, 200, 83, 0.35);
}

.attach-contact {
    background: linear-gradient(135deg, #00ACC1, #4DD0E1);
    box-shadow: 0 4px 12px rgba(0, 172, 193, 0.35);
}

.attach-option-label {
    font-size: 11px;
    color: rgba(255, 255, 255, 0.6);
}

/* ───── EMOJI PICKER (Glass) ───── */
.emoji-picker-panel {
    width: 100% !important;
    height: 0 !important;
    max-height: 0 !important;
    overflow: hidden !important;
    display: flex !important;
    flex-direction: column !important;
    flex-shrink: 0 !important;
    /* Glass */
    background: rgba(11, 20, 26, 0.95) !important;
    background-color: rgba(11, 20, 26, 0.95) !important;
    backdrop-filter: blur(40px);
    -webkit-backdrop-filter: blur(40px);
    border-top: 1px solid rgba(255, 255, 255, 0.06) !important;
    transition: max-height 0.3s ease, height 0.3s ease !important;
}

.emoji-picker-panel.show {
    height: 300px !important;
    max-height: 300px !important;
}

.emoji-categories,
.emoji-tabs {
    display: flex !important;
    padding: 8px 4px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.06) !important;
    overflow-x: auto;
    gap: 2px;
    background: rgba(11, 20, 26, 0.95) !important;
    background-color: rgba(11, 20, 26, 0.95) !important;
}

.emoji-category-btn {
    padding: 6px 10px;
    font-size: 18px;
    border-radius: 8px;
    flex-shrink: 0;
    cursor: pointer;
    transition: background 0.15s;
    color: rgba(255, 255, 255, 0.5);
}

.emoji-category-btn:hover,
.emoji-category-btn.active {
    background: rgba(255, 255, 255, 0.08);
    color: rgba(255, 255, 255, 0.9);
}

.emoji-scroll-area {
    height: calc(100% - 44px);
    overflow-y: auto;
    padding: 8px;
}

.emoji-grid {
    display: grid;
    grid-template-columns: repeat(8, 1fr);
    gap: 2px;
}

.emoji-item {
    font-size: 24px;
    text-align: center;
    padding: 4px 0;
    cursor: pointer;
    border-radius: 8px;
    transition: background 0.1s, transform 0.1s;
    user-select: none;
}

.emoji-item:hover {
    background: rgba(255, 255, 255, 0.08);
}

.emoji-item:active {
    transform: scale(1.3);
}

/* Skin Tone Popup */
.skin-tone-popup {
    position: absolute;
    background: rgba(20, 32, 40, 0.95);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
    padding: 6px;
    display: none;
    z-index: 60;
}

.skin-tone-popup.show {
    display: flex;
    gap: 4px;
}

/* ───── IMAGE PREVIEW & VIEWER (Glass) ───── */
.image-preview-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 300;
    display: none;
    flex-direction: column;
    background: rgba(0, 0, 0, 0.92);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
}

.image-preview-overlay.show {
    display: flex;
}

.image-preview-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    background: rgba(11, 20, 26, 0.8);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.06);
}

.image-preview-body {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
}

.image-preview-body img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

.image-preview-footer {
    display: flex;
    align-items: flex-end;
    padding: 12px 16px;
    gap: 12px;
    background: rgba(11, 20, 26, 0.8);
    backdrop-filter: blur(20px);
    border-top: 1px solid rgba(255, 255, 255, 0.06);
}

.image-preview-footer .message-input {
    flex: 1;
}

.image-preview-footer .send-btn {
    width: 42px;
    height: 42px;
}

/* Fullscreen Viewer */
.fullscreen-viewer {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 500;
    display: none;
    flex-direction: column;
    background: rgba(0, 0, 0, 0.95);
}

.fullscreen-viewer.show {
    display: flex;
}

.viewer-controls {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    background: rgba(11, 20, 26, 0.7);
    backdrop-filter: blur(15px);
}

.viewer-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background 0.15s;
}

.viewer-btn:hover {
    background: rgba(255, 255, 255, 0.15);
}

.viewer-btn:active {
    transform: scale(0.9);
}

/* ───── BACKDROP-FILTER FALLBACK ───── */
@supports not (backdrop-filter: blur(1px)) {
    .chat-header {
        background: rgba(11, 20, 26, 0.95) !important;
    }

    .chat-input-area {
        background: rgba(11, 20, 26, 0.95) !important;
    }

    .message-bubble.sent {
        background: rgba(0, 60, 48, 0.85) !important;
    }

    .message-bubble.received {
        background: rgba(30, 40, 50, 0.85) !important;
    }

    .blur-overlay {
        background: rgba(0, 0, 0, 0.7) !important;
    }

    .dropdown-menu {
        background: rgba(20, 32, 40, 0.95) !important;
    }

    .confirm-dialog {
        background: rgba(20, 32, 40, 0.98) !important;
    }
}

/* ───── REDUCED MOTION ───── */
@media (prefers-reduced-motion: reduce) {

    .chat-wallpaper,
    .chat-wallpaper::before,
    .typing-dot,
    .send-btn,
    .online-dot {
        animation: none !important;
    }
}