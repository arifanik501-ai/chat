<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#021A12">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>WhatsApp Clone Phase 2</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üí¨</text></svg>">
    <link rel="stylesheet" href="style.css">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
</head>

<body>
    <div id="app">
        <!-- GLOBAL TOAST CONTAINER -->
        <div id="toastContainer" class="toast-container"></div>

        <!-- HOMEPAGE -->
        <div id="homepage" class="screen active">
            <!-- LAYER 0: Liquid Gradient Base -->
            <div class="hp-liquid-bg"></div>

            <!-- LAYER 1: Mesh Gradient Blobs -->
            <div class="hp-mesh-blobs">
                <div class="mesh-blob blob-a"></div>
                <div class="mesh-blob blob-b"></div>
                <div class="mesh-blob blob-c"></div>
                <div class="mesh-blob blob-d"></div>
                <div class="mesh-blob blob-e"></div>
            </div>

            <!-- LAYER 2: Particles (JS-generated) -->
            <div class="hp-particles" id="particlesContainer"></div>

            <!-- LAYER 3: Noise + Vignette -->
            <div class="hp-noise-overlay"></div>
            <div class="hp-vignette"></div>

            <!-- LAYER 4: Decorative Liquid Blobs -->
            <div class="hp-liquid-blob liquid-blob-1"></div>
            <div class="hp-liquid-blob liquid-blob-2"></div>
            <div class="hp-liquid-blob liquid-blob-3"></div>

            <!-- LAYER 5: Main Content -->
            <div class="hp-content">
                <!-- Glass Header -->
                <div class="hp-glass-header" id="homeHeader">
                    <div class="hp-glass-reflection"></div>
                    <div class="hp-logo" id="homeLogo">
                        <svg viewBox="0 0 24 24" width="42" height="42" fill="currentColor">
                            <path
                                d="M12.01 2.06c-5.5 0-9.96 4.46-9.96 9.96 0 1.76.46 3.42 1.25 4.88L2 22l5.32-1.39A9.914 9.914 0 0012.01 22a9.96 9.96 0 000-19.94zm0 18.23c-1.47 0-2.88-.39-4.13-1.13l-.3-.18-3.07.8.82-3-.2-.31a8.216 8.216 0 01-1.35-4.47c0-4.54 3.7-8.24 8.23-8.24s8.24 3.7 8.24 8.24c0 4.54-3.7 8.24-8.24 8.24zm4.51-6.16c-.25-.12-1.47-.72-1.69-.81-.23-.08-.39-.12-.56.12-.17.25-.64.81-.79.98-.15.17-.3.19-.55.06-.25-.12-1.05-.39-2-1.23-.74-.66-1.23-1.47-1.38-1.72-.15-.25-.02-.38.11-.51.11-.11.25-.29.37-.43.12-.15.17-.25.25-.41.08-.17.04-.31-.02-.43-.06-.12-.56-1.34-.76-1.84-.2-.48-.41-.42-.56-.43h-.48c-.17 0-.43.06-.66.31-.23.25-.88.86-.88 2.09 0 1.23.9 2.42 1.03 2.59.13.17 1.77 2.7 4.28 3.78 1.48.64 2.19.78 2.97.74.88-.04 2.01-.83 2.29-1.63.28-.8.28-1.49.2-1.63-.08-.15-.29-.24-.54-.36z" />
                        </svg>
                    </div>
                    <h1 class="hp-title">WhatsApp</h1>
                    <p class="hp-subtitle" id="homeWelcome">CHOOSE YOUR IDENTITY</p>
                    <div class="hp-title-line"></div>
                </div>

                <!-- Glass Cards -->
                <div class="hp-cards">
                    <!-- Anik Card -->
                    <div class="hp-glass-card card-anik" onclick="selectUser('anik')">
                        <div class="hp-avatar-ring ring-anik">
                            <div class="hp-avatar avatar-anik">A</div>
                            <span class="hp-online-dot"></span>
                        </div>
                        <div class="hp-card-info">
                            <h2>Anik</h2>
                            <p>Tap to chat as Anik</p>
                        </div>
                        <span class="hp-card-arrow">‚Ä∫</span>
                    </div>

                    <!-- Priya Card -->
                    <div class="hp-glass-card card-priya" onclick="selectUser('priya')">
                        <div class="hp-avatar-ring ring-priya">
                            <div class="hp-avatar avatar-priya">P</div>
                            <span class="hp-online-dot"></span>
                        </div>
                        <div class="hp-card-info">
                            <h2>Priya</h2>
                            <p>Tap to chat as Priya</p>
                        </div>
                        <span class="hp-card-arrow">‚Ä∫</span>
                    </div>
                </div>

                <!-- Bottom Section -->
                <div class="hp-bottom">
                    <p class="hp-encrypted">üîí END-TO-END ENCRYPTED</p>
                    <div class="hp-dots">
                        <span></span><span></span><span></span><span></span><span></span>
                        <span></span><span></span><span></span><span></span><span></span>
                        <span></span><span></span><span></span><span></span><span></span>
                    </div>
                    <p class="hp-version">v2.24.1</p>
                </div>
            </div>

            <!-- Glow Spot behind cards -->
            <div class="hp-glow-spot"></div>
        </div>

        <!-- CHAT SCREEN -->
        <div id="chatscreen" class="screen">
            <!-- Header -->
            <header class="chat-header" id="chatHeader">
                <div class="header-left" onclick="goBack()">
                    <button class="back-btn ripple-effect-js" id="backBtn" aria-label="Back">
                        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                            <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" />
                        </svg>
                    </button>
                    <div class="chat-avatar" id="chatHeaderAvatar"></div>
                    <div class="chat-title-container">
                        <span class="chat-title" id="chatHeaderName">
                            Contact
                            <span class="online-dot" id="onlineDot"></span>
                        </span>
                        <div class="chat-status-wrapper" id="chatStatusWrapper">
                            <span class="chat-status slot-visible" id="chatHeaderStatus">connecting...</span>
                            <span class="chat-status slot-hidden-down" id="chatHeaderStatusNext"></span>
                        </div>
                    </div>
                </div>
                <div class="header-right">
                    <button class="menu-btn ripple-effect-js" id="menuBtn" aria-label="Menu"
                        onclick="toggleMenu(event)">
                        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                            <path
                                d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" />
                        </svg>
                    </button>
                </div>
            </header>

            <!-- Wallpaper Background -->
            <div class="chat-wallpaper" id="chatWallpaper"></div>

            <!-- Top Overscroll Glow -->
            <div class="messages-top-glow" id="messagesTopGlow"></div>

            <!-- Messages Area -->
            <main class="chat-messages" id="messagesArea">
                <div class="messages-container" id="messagesContainer">
                    <div class="skeleton-loader" id="skeletonLoader">
                        <div class="skeleton-bubble left w60"></div>
                        <div class="skeleton-bubble right w50"></div>
                        <div class="skeleton-bubble left w70"></div>
                        <div class="skeleton-bubble right w45"></div>
                    </div>
                </div>

                <!-- Scroll to Bottom Floating Button -->
                <button class="scroll-bottom-btn ripple-effect-js" id="scrollBottomBtn" onclick="scrollToBottom(true)">
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                        <path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z" />
                    </svg>
                    <span class="unread-badge" id="unreadBadge">0</span>
                </button>
            </main>

            <!-- Input Area -->
            <footer class="chat-input-area" id="chatInputArea">
                <div class="input-container" id="inputContainer">
                    <button class="emoji-btn ripple-effect-js" id="emojiBtn" aria-label="Emoji"
                        onclick="toggleEmojiPicker()">
                        <div class="emoji-icon-container">
                            <!-- Smiley -->
                            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor" class="icon-smiley">
                                <path
                                    d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z" />
                            </svg>
                            <!-- Keyboard -->
                            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor" class="icon-keyboard">
                                <path
                                    d="M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z" />
                            </svg>
                        </div>
                    </button>

                    <div id="messageInput" class="message-input" contenteditable="true"
                        data-placeholder="Type a message..."></div>

                    <button class="attach-btn ripple-effect-js" id="attachBtn" aria-label="Attach"
                        onclick="toggleAttachmentMenu(event)">
                        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                            <path
                                d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5a2.5 2.5 0 0 1 5 0v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5a2.5 2.5 0 0 0 5 0V5c0-3.31-2.69-6-6-6S3 1.69 3 5v12.5c0 3.86 3.14 7 7 7s7-3.14 7-7V6h-1.5z">
                            </path>
                        </svg>
                    </button>

                    <button class="camera-btn ripple-effect-js" aria-label="Camera" onclick="openDeviceCamera()">
                        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                            <path
                                d="M4 4h3l2-2h6l2 2h3c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2zm8 3c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0 8c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3z" />
                        </svg>
                        <input type="file" id="cameraInput" accept="image/*" capture="environment"
                            style="display: none;" onchange="handleImageSelection(event)">
                    </button>
                </div>

                <button class="action-btn-container ripple-effect-js" id="sendBtn" onclick="handleSendAction()">
                    <!-- Microphone -->
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor" class="action-icon-mic">
                        <path
                            d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.91-3c-.49 0-.9.36-.98.85C16.52 14.2 14.47 16 12 16s-4.52-1.8-4.93-4.15c-.08-.49-.49-.85-.98-.85-.61 0-1.09.54-1 1.14.49 3 2.89 5.35 5.91 5.78V20c0 .55.45 1 1 1s1-.45 1-1v-2.08c3.02-.43 5.42-2.78 5.91-5.78.1-.6-.39-1.14-1-1.14z" />
                    </svg>
                    <!-- Send -->
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor" class="action-icon-send">
                        <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
                    </svg>
                </button>
            </footer>

            <!-- Emoji Picker Panel -->
            <div class="emoji-picker-panel" id="emojiPickerPanel">
                <div class="emoji-tabs">
                    <button class="emoji-tab ripple-effect-js active" data-category="recent">üïê</button>
                    <button class="emoji-tab ripple-effect-js" data-category="smileys">üòä</button>
                    <button class="emoji-tab ripple-effect-js" data-category="gestures">üëã</button>
                    <button class="emoji-tab ripple-effect-js" data-category="animals">üêæ</button>
                    <button class="emoji-tab ripple-effect-js" data-category="food">üçî</button>
                    <button class="emoji-tab ripple-effect-js" data-category="activities">‚öΩ</button>
                    <button class="emoji-tab ripple-effect-js" data-category="travel">‚úàÔ∏è</button>
                    <button class="emoji-tab ripple-effect-js" data-category="objects">üí°</button>
                    <button class="emoji-tab ripple-effect-js" data-category="symbols">‚ù§Ô∏è</button>
                    <button class="emoji-tab ripple-effect-js" data-category="flags">üè≥Ô∏è</button>
                    <div class="emoji-tab-indicator" id="emojiTabIndicator"></div>
                </div>

                <div class="emoji-search-container">
                    <div class="emoji-search-bar">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                            <path
                                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                        </svg>
                        <input type="text" id="emojiSearchInput" placeholder="Search emoji" autocomplete="off">
                    </div>
                </div>

                <div class="emoji-scroll-area" id="emojiScrollArea">
                    <div class="emoji-no-results" id="emojiNoResults" style="display: none;">
                        <span class="sad-emoji">üòï</span>
                        <p>No emoji found</p>
                    </div>
                    <!-- Dynamically populated by JS -->
                </div>
            </div>

            <!-- Emoji Skin Tone Popup -->
            <div class="skin-tone-popup" id="skinTonePopup">
                <!-- Dynamically populated -->
            </div>
        </div>

        <!-- UI OVERLAYS & MODALS -->
        <div class="blur-overlay" id="blurOverlay" onclick="closeAllModals()">

            <!-- Three Dot Menu -->
            <div class="dropdown-menu" id="dropdownMenu" onclick="event.stopPropagation()">
                <div class="menu-item ripple-effect-js">View Contact</div>
                <div class="menu-item ripple-effect-js">Media, links, and docs</div>
                <div class="menu-item ripple-effect-js">Search</div>
                <div class="menu-item ripple-effect-js">Mute notifications</div>
                <div class="menu-item ripple-effect-js">Wallpaper</div>
                <div class="menu-item ripple-effect-js" onclick="clearMessagesDialog()">Clear chat</div>
            </div>

            <!-- Confirm Dialog -->
            <div class="dialog-box" id="confirmDialog" onclick="event.stopPropagation()">
                <h3>Clear this chat?</h3>
                <p>Messages will be removed from this device.</p>
                <div class="dialog-actions">
                    <button class="dialog-btn cancel-btn ripple-effect-js" onclick="closeAllModals()">Cancel</button>
                    <button class="dialog-btn delete-btn ripple-effect-js" onclick="executeClearChat()">Clear
                        chat</button>
                </div>
            </div>

        </div>

        <div class="blur-overlay no-blur" id="transparentOverlay" onclick="closeAllModals()">
            <!-- Attachment Menu -->
            <div class="attachment-menu" id="attachmentMenu">
                <div class="attach-grid">
                    <div class="attach-option">
                        <div class="attach-icon-wrapper" style="background:#5F66CD">
                            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                                <path
                                    d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" />
                            </svg>
                        </div>
                        <span>Document</span>
                    </div>
                    <div class="attach-option">
                        <div class="attach-icon-wrapper" style="background:#E12C57">
                            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                                <path
                                    d="M12 12c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm6-1.8C18 6.57 15.35 4 12 4s-6 2.57-6 6.2c0 2.34 1.95 5.44 6 9.14 4.05-3.7 6-6.8 6-9.14zM12 2c2.76 0 5 2.24 5 5 0 3.65-3 7-5 11-2-4-5-7.35-5-11 0-2.76 2.24-5 5-5z" />
                            </svg>
                        </div>
                        <span>Camera</span>
                    </div>
                    <label class="attach-option">
                        <div class="attach-icon-wrapper" style="background:#B663F0">
                            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                                <path
                                    d="M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2zm-11-4l2.03 2.71L16 11l4 5H8l3-4zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6H2z" />
                            </svg>
                        </div>
                        <span>Gallery</span>
                        <input type="file" id="imageInput" accept="image/*" style="display: none;"
                            onchange="handleImageSelection(event)">
                    </label>
                    <div class="attach-option">
                        <div class="attach-icon-wrapper" style="background:#E25A24">
                            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                                <path
                                    d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z" />
                            </svg>
                        </div>
                        <span>Audio</span>
                    </div>
                    <div class="attach-option">
                        <div class="attach-icon-wrapper" style="background:#20A65F">
                            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                                <path
                                    d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
                            </svg>
                        </div>
                        <span>Location</span>
                    </div>
                    <div class="attach-option">
                        <div class="attach-icon-wrapper" style="background:#4BA3E3">
                            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                                <path
                                    d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                            </svg>
                        </div>
                        <span>Contact</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Image Preview Modal -->
        <div class="preview-modal" id="previewModal">
            <header class="preview-header">
                <button class="close-preview-btn ripple-effect-js" onclick="closeImagePreview()">
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                        <path
                            d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
                    </svg>
                </button>
                <div class="preview-header-actions">
                    <button class="preview-action-btn ripple-effect-js">
                        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                            <path
                                d="M17 15h2V7c0-1.1-.9-2-2-2H9v2h8v8zM7 17V1H5v4H1v2h4v10c0 1.1.9 2 2 2h10v4h2v-4h4v-2H7z" />
                        </svg>
                    </button>
                </div>
            </header>

            <div class="preview-image-container">
                <div class="preview-compressing-text" id="previewCompressingText">Compressing...</div>
                <img src="" id="previewImage" class="preview-main-image">
            </div>

            <footer class="preview-footer">
                <div class="thumbnail-strip-container" id="thumbnailStripContainer" style="display: none;">
                    <!-- Thumbnails populated here if multiple images -->
                </div>
                <div class="caption-input-container">
                    <span class="caption-char-count" id="captionCharCount">0 / 1024</span>
                    <input type="text" id="captionInput" class="caption-input" placeholder="Add a caption..."
                        autocomplete="off">
                </div>
                <!-- Send/Progress Button -->
                <button class="preview-send-btn ripple-effect-js" id="previewSendBtn" onclick="sendPreviewImage()">
                    <!-- Send Arrow -->
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor" class="send-arrow"
                        id="previewSendArrow">
                        <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
                    </svg>

                    <!-- Progress SVG (hidden initially) -->
                    <svg class="preview-progress-ring" id="previewProgressRing" viewBox="0 0 40 40"
                        style="display: none;">
                        <circle class="ring-bg" cx="20" cy="20" r="18"></circle>
                        <circle class="ring-progress" id="previewProgressCircle" cx="20" cy="20" r="18"></circle>
                    </svg>
                    <span class="preview-progress-text" id="previewProgressText" style="display: none;">0%</span>

                    <!-- Cancel Stop Icon (hidden initially) -->
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="cancel-upload-icon"
                        id="previewCancelIcon" style="display: none;">
                        <path d="M6 6h12v12H6z" />
                    </svg>
                </button>
            </footer>
        </div>

        <!-- Fullscreen Image Viewer -->
        <div class="fullscreen-viewer" id="fullscreenViewer">
            <header class="viewer-header" id="viewerHeader">
                <button class="viewer-nav-btn ripple-effect-js" onclick="closeFullscreenViewer()">
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" />
                    </svg>
                </button>
                <div class="viewer-info">
                    <span class="viewer-name" id="viewerName">Contact Name</span>
                    <span class="viewer-time" id="viewerTime">12:30 PM</span>
                </div>
                <div class="viewer-actions">
                    <button class="viewer-action-btn ripple-effect-js">
                        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                            <path
                                d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" />
                        </svg>
                    </button>
                    <button class="viewer-action-btn ripple-effect-js" id="viewerDownloadBtn"
                        onclick="downloadViewerImage()">
                        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                            <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z" />
                        </svg>
                    </button>
                    <button class="viewer-action-btn ripple-effect-js">
                        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                            <path
                                d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" />
                        </svg>
                    </button>
                </div>
            </header>

            <div class="viewer-image-track" id="viewerImageTrack">
                <!-- Shared element clone target -->
                <img src="" id="viewerMainImage" class="viewer-image">
            </div>

            <footer class="viewer-footer" id="viewerFooter">
                <div class="viewer-caption" id="viewerCaption"></div>
                <div class="viewer-thumbnails" id="viewerThumbnails"></div>
            </footer>
        </div>

        <!-- Long Press Context Menu -->
        <div class="context-menu" id="messageContextMenu">
            <div class="menu-item ripple-effect-js" onclick="handleContextDownload()">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                    <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z" />
                </svg>
                <span>Save</span>
            </div>
            <div class="menu-item ripple-effect-js">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                    <path
                        d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" />
                </svg>
                <span>Star</span>
            </div>
            <div class="menu-item ripple-effect-js">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                    <path d="M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z" />
                </svg>
                <span>Forward</span>
            </div>
            <div class="menu-item ripple-effect-js context-delete" id="contextDeleteBtn">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                    <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" />
                </svg>
                <span>Delete</span>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>